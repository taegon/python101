<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GIS용 자료구축하기 | Python 101</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/python101/logo.png">
    <meta name="description" content="대학원생을 위한 파이썬 기초">
    
    <link rel="preload" href="/python101/assets/css/0.styles.9b1dda7f.css" as="style"><link rel="preload" href="/python101/assets/js/app.dbb036ea.js" as="script"><link rel="preload" href="/python101/assets/js/2.95d799da.js" as="script"><link rel="preload" href="/python101/assets/js/19.0fc45761.js" as="script"><link rel="prefetch" href="/python101/assets/js/10.36fde300.js"><link rel="prefetch" href="/python101/assets/js/11.13fb88b8.js"><link rel="prefetch" href="/python101/assets/js/12.9de15419.js"><link rel="prefetch" href="/python101/assets/js/13.f291c9a6.js"><link rel="prefetch" href="/python101/assets/js/14.553285a3.js"><link rel="prefetch" href="/python101/assets/js/15.e39fd445.js"><link rel="prefetch" href="/python101/assets/js/16.fc76248a.js"><link rel="prefetch" href="/python101/assets/js/17.518b50dd.js"><link rel="prefetch" href="/python101/assets/js/18.989d7fc4.js"><link rel="prefetch" href="/python101/assets/js/20.64c64fbb.js"><link rel="prefetch" href="/python101/assets/js/3.cbcaddd8.js"><link rel="prefetch" href="/python101/assets/js/4.96519e85.js"><link rel="prefetch" href="/python101/assets/js/5.024706a7.js"><link rel="prefetch" href="/python101/assets/js/6.51655b54.js"><link rel="prefetch" href="/python101/assets/js/7.6709e416.js"><link rel="prefetch" href="/python101/assets/js/8.8319188a.js"><link rel="prefetch" href="/python101/assets/js/9.c034811f.js">
    <link rel="stylesheet" href="/python101/assets/css/0.styles.9b1dda7f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/python101/" class="home-link router-link-active"><!----> <span class="site-name">Python 101</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/taegon/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://code.taegon.kr/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/taegon/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://code.taegon.kr/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>강의자료</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/python101/ch00-prologue.html" class="sidebar-link">들어가며</a></li><li><a href="/python101/ch01-setup.html" class="sidebar-link">파이썬 환경 구축하기</a></li><li><a href="/python101/ch02-hello-world.html" class="sidebar-link">Hello, World</a></li><li><a href="/python101/ch03-syntax.html" class="sidebar-link">기본기 다지기</a></li><li><a href="/python101/ch04-read-file.html" class="sidebar-link">파일 읽기</a></li><li><a href="/python101/ch05-write-file.html" class="sidebar-link">파일 쓰기</a></li><li><a href="/python101/ch06-handling-files.html" class="sidebar-link">여러개 파일 읽고 쓰기</a></li><li><a href="/python101/ch07-function.html" class="sidebar-link">함수: 프로그램 조각내기</a></li><li><a href="/python101/ch08-statistics.html" class="sidebar-link">연도별 통계 만들기</a></li><li><a href="/python101/ch09-monthly-statistics.html" class="sidebar-link">월별 통계 만들기</a></li><li><a href="/python101/ch10-GIS-table.html" aria-current="page" class="active sidebar-link">GIS용 자료구축하기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/python101/ch10-GIS-table.html#배열을-이용하여-구현하기" class="sidebar-link">배열을 이용하여 구현하기</a></li><li class="sidebar-sub-header"><a href="/python101/ch10-GIS-table.html#사전형을-이용하여-구현하기" class="sidebar-link">사전형을 이용하여 구현하기</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A. 부록</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="gis용-자료구축하기"><a href="#gis용-자료구축하기" class="header-anchor">#</a> GIS용 자료구축하기</h1> <p>지금까지 만들어 온 프로그램을 바탕으로 GIS에서 불러올 수 있는 형태를 만들어 보도록 하겠다. 아래 형태와 같이 측후소별로 연별 강수량 테이블을 만들면, join 기능을 이용하여 지도를 생성할 수 있다. 이번 장에는 아래 형태의 출력파일을 만들어보도록 하자.</p> <div class="language- extra-class"><pre class="language-text"><code>MS,  Y1973,  Y1974
90,   1300,   1200
100,   900,    1100
119,   2000,   1000
....
....
295,   1500,   1200
</code></pre></div><h2 id="배열을-이용하여-구현하기"><a href="#배열을-이용하여-구현하기" class="header-anchor">#</a> 배열을 이용하여 구현하기</h2> <p>앞서 배운 바와 같이 미리 배열의 크기를 결정할 수 있다면, 리스트를 이용하여 구현할 수 있다. 먼저 측후소별, 연도별로 자료를 모으는 코드부터 작성해보자.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_annual_prec_table</span><span class="token punctuation">(</span>stations<span class="token punctuation">)</span><span class="token punctuation">:</span>
    start_year <span class="token operator">=</span> <span class="token number">1973</span>
    end_year <span class="token operator">=</span> <span class="token number">1974</span>
    station_dataset <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> station <span class="token keyword">in</span> stations<span class="token punctuation">:</span>
        filename <span class="token operator">=</span> <span class="token string">&quot;../../input/python101/&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>station<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.txt&quot;</span>
        dataset <span class="token operator">=</span> read_dataset<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>

        annual_prec <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start_year<span class="token punctuation">,</span> end_year <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

        <span class="token keyword">for</span> data <span class="token keyword">in</span> dataset<span class="token punctuation">:</span>
            year <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            idx <span class="token operator">=</span> year <span class="token operator">-</span> start_year
            <span class="token keyword">if</span> idx <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            <span class="token keyword">if</span> idx <span class="token operator">&gt;=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>annual_prec<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            annual_prec<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">+=</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
        station_dataset<span class="token punctuation">.</span>append<span class="token punctuation">(</span>annual_prec<span class="token punctuation">)</span>

    <span class="token keyword">return</span> station_dataset
</code></pre></div><p>앞서 8장에서 작성한 코드를 그대로 활용하되, 측후소별로 자료를 모을 수 있도록 리스트를 한겹 더 감싸도록 하였다. <code>station_dataset</code>에는 각 측후소별로 연도별 강수량합계인 <code>annual_prec</code>가 저장되게 된다. 이 함수를 호출할 때, 측후소번호를 리스트로 넘겨주어야 한다. 이렇게 작성하는 이유는 테스트할 때는 간단히 <code>get_annual_prec_table([90,100])</code>과 같이 2개 측후소만 넣고 돌릴 수 있다. 프로그램이 잘 돌아가는 것을 확인한 후, 전체 측후소 리스트는 넘겨주면 된다. 전체 측후소 리스트는 앞서 배웠듯이 손으로 직접 다 써주어도 되지만, 특정 디렉토리의 파일명을 읽어도 되고, 측후소 리스트가 적힌 텍스트 파일을 만들어두고 해당파일을 읽어도 된다.</p> <p>메인함수는 8장에서 작성한 것을 다소 수정해야하는데, 그 이유는 8장에서는 측후소에 대하여 메인함수에서 루프를 만들었으나, 이번 장에서는 <code>get_annual_prec_table()</code>함수에서 반복문을 구성하고 있기 때문이다. 메인함수는 다음과 같다.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    station_ids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">]</span>

    annual_prec <span class="token operator">=</span> get_annual_prec_table<span class="token punctuation">(</span>station_ids<span class="token punctuation">)</span>
    print_annual_prec_table<span class="token punctuation">(</span>annual_prec<span class="token punctuation">,</span> station_ids<span class="token punctuation">)</span>
</code></pre></div><p>측후소에 대한 반복문이 사라지고, 단순히 리스트만 넘겨주면 되므로 코드가 훨씬 간단해졌다.</p> <p>이렇게 읽어들인 자료의 출력은 아래와 같이 어렵지 않게 구현할 수 있다.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">print_annual_prec_table</span><span class="token punctuation">(</span>station_dataset<span class="token punctuation">,</span> stations<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MS&quot;</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    start_year <span class="token operator">=</span> <span class="token number">1973</span>
    end_year <span class="token operator">=</span> <span class="token number">1974</span>
    <span class="token keyword">for</span> year <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start_year<span class="token punctuation">,</span> end_year <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;,Y{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> i<span class="token punctuation">,</span> dataset <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>station_dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>stations<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> data <span class="token keyword">in</span> dataset<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;,{:.1f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="사전형을-이용하여-구현하기"><a href="#사전형을-이용하여-구현하기" class="header-anchor">#</a> 사전형을 이용하여 구현하기</h2> <p>파이썬에서는 리스트와 사전형 자료형이 기본 제공되어 C언어나 여타 언어에 비해 코드를 작성하기 편리한 점이 있다. 앞서 배열을 이용하여 구현한 방식과 달리 사전형을 이용하여 구현하는 방법에 대해 살펴보겠다. 사전형으로 구현하면, 인덱스 계산을 고민하지 않아도 되기 때문에 코드를 읽기가 조금 더 수월하다.</p> <p>위에서 작성한 자료읽기와 출력부분은 아래와 같이 작성할 수 있다. 위 코드와 비교하며 살펴보자.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_annual_prec_table_using_dict</span><span class="token punctuation">(</span>stations<span class="token punctuation">)</span><span class="token punctuation">:</span>
    station_dataset <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> station <span class="token keyword">in</span> stations<span class="token punctuation">:</span>
        filename <span class="token operator">=</span> <span class="token string">&quot;../../input/python101/&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>station<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.txt&quot;</span>
        dataset <span class="token operator">=</span> read_dataset<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>

        <span class="token keyword">for</span> data <span class="token keyword">in</span> dataset<span class="token punctuation">:</span>
            year <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            key <span class="token operator">=</span> <span class="token punctuation">(</span>station<span class="token punctuation">,</span> year<span class="token punctuation">)</span>

            <span class="token keyword">if</span> key <span class="token keyword">in</span> station_dataset<span class="token punctuation">:</span>
                station_dataset<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                station_dataset<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>

    <span class="token keyword">return</span> station_dataset


<span class="token keyword">def</span> <span class="token function">print_annual_prec_table_using_dict</span><span class="token punctuation">(</span>station_dataset<span class="token punctuation">,</span> stations<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MS&quot;</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    start_year <span class="token operator">=</span> <span class="token number">1973</span>
    end_year <span class="token operator">=</span> <span class="token number">1974</span>
    <span class="token keyword">for</span> year <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start_year<span class="token punctuation">,</span> end_year <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;,Y{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> station <span class="token keyword">in</span> stations<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>station<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> year <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start_year<span class="token punctuation">,</span> end_year <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            key <span class="token operator">=</span> <span class="token punctuation">(</span>station<span class="token punctuation">,</span> year<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;,{:.1f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>station_dataset<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/15/2022, 10:24:45 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/python101/ch09-monthly-statistics.html" class="prev">
        월별 통계 만들기
      </a></span> <span class="next"><a href="/python101/ch80-download-weather.html">
        부록 A: 기상청 자료 받기
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/python101/assets/js/app.dbb036ea.js" defer></script><script src="/python101/assets/js/2.95d799da.js" defer></script><script src="/python101/assets/js/19.0fc45761.js" defer></script>
  </body>
</html>
